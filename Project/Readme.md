Проектная работа\
Тема: **Разработка дизайна сети геораспределенного ЦОД компании с использованием VxLAN**\
Содержание:
- Постановка задачи
- Общая концепция решения
- Схема сети
- Адресный план
- Виртуальное моделирование

**Постановка задачи**\
  В геораспределенную структуру компании (центральный офис, филиалы, представительства, ЦОД) планируется добавить дублирующий центр обработки данных с целью обеспечения катастрофоустойчивости (полный выход из строя) основного. Таким образом непосредственно бизнес сервисы функционируют независимо друг от друга, но
  при этом обеспечивается репликация баз данных. файловых серверов, контроллеров домена и т.п., чтобы при запуске в работу второго ЦОД расхождения в актуальности данных (потеря данных) были минимальными. Дублирующий ЦОД располагается в удаленной географической точке (как минимум другой регион). Канал связи между ЦОД - L2VPN или Интернет, выделение оптического волокна или волны у провайдера услуг связи не предусматривается. Миграция виртуальных машин предполагается  только в пределах одного ЦОД. Непрерывное управление инфраструктурой и мониторинг обоих ЦОД должны обеспечиваться из Центрального офиса.

**Общая концепция решения**\
Для решения поставленной задачи предлагается:
- Использовать топологию CLOS с двумя Spine коммутаторами и 4 Leaf, собранными в VPC (MLAG, ESI) пары в зависимости от вендора.
- Одна из пар выполняет функции Boarder Leaf для подключения маршрутизаторов и межсетевых экранов.
- Нагрузка (конечные устройства) подключаются к Leaf с использованием LAG минимум двумя линиями.
- На базе топологии CLOS построить IP-фабрику и для работы Underlay применить протокол eBGP (выбор может быть изменен в пользу iBGP или протоклов IGP, если это рекомендует вендор).
- Для ускорения реакции протоколов маршрутизации на сбои использовать протокол BFD, а для балансировки нагрузки внутри фабрики включить ECMP (path > 8). 
- Overlay сеть построить на основе VxLAN, а в качетстве его Control Plane применить расширение BGP - EVPN.
- Поэтапно придти к архитектуре 2-х ЦОД объединенных в Multipod. Два промежуточных этапа - это построение фабрики во втором ЦОД и соединение ее с первым, затем построение фабрики в первом ЦОД.
- Связать площадки по L3. На каждой площадке использовать уникальную адресацию... (?)
- IT-инфраструктура ЦОД поместить в отдельный VRF, с возможность горизонтального взаимодействия между собой и инфрастурктурой первого ЦОД без участия FW. На этапе Multifabric стараемся не использовать много VRF из-за сложностей дальнейшего масштабирования.
- Взаимодействие инфраструктуры с сервисами и Интернет осуществляется при необходимости через FW.
- В случае сжатых сроков, необходимости предоставлять сервисы L2 возможен маневр - при достаточном MTU в DCI один коммутатор из состава Boarder Leaf разместить в ЦОД1, затерминировав на нем подсети IT-инфраструктуры и построив через него Multipod. В дальнейшем развивать эту схему.

Плюсы данного решения:
- Обеспечивается минимум двойное резервирование на уровне: соединительных линий, узлов сети и путей прохождения трафика (включая возможность балансировки нагрузки).
- Присутствует возможность балансировки нагрузки в IP-фабрике за счет ECMP.
- Отсутствует L2 сегмент, и следовательно вероятность образования петель и broadcast-штормов, нет необходимости в настройке STP, прощу и безопаснее проводить работы по коммутации.
- Отсутствет стекирование, у каждого устройства независимый Control Plane, сделовательно проще выполнять работы по обслуживанию (обновлению ПО).
- Простота масштабирования, добавления новых узлова сети и даже ЦОД (в случае Multipod).
- Проста и удобство конфигурации: после построения Underlay и Overlay изменения вносятся только на Leaf, что создает благоприятные условия для внедрения элементов автоматизации.
- В случае использования eBGP имеем единый протокол для Underlay и Overlay, что также упрощает конфигурацию.

 Недостатки решения:
 - Необходимость в большем количестве коммутаторов в стравнении с текущим Tier3.
 - Необходимось в более компетентных инженерах.
 - И как следствие первых двух пунктов вероятность значительного удорожания и увеличения сроков реализации проекта в целом.

**Схема сети**
0-й этап Tier3

<img width="1674" height="2385" alt="image" src="https://github.com/user-attachments/assets/98c0bd63-10d7-4391-95e8-8aaf3bd13788" />

1-й этап SingleFabric

<img width="2817" height="1986" alt="image" src="https://github.com/user-attachments/assets/fede1edc-a445-4df9-bafb-25e9cd216e23" />

2-й этап MultiFabric

<img width="2199" height="1518" alt="image" src="https://github.com/user-attachments/assets/d3ed4546-5c99-4ef0-87e4-aa26380c58a8" />

3-й этап MultiPod

<img width="3109" height="2106" alt="image" src="https://github.com/user-attachments/assets/5054c8d7-1e68-4425-8c2f-72d305bccb51" />

**Адресный план**
ЦОД1 \
172.16.0.0/16 - суммарный маршрут для сетевой адресации.
- 172.16.A.B/32 - адресация для loopback-интерфейсов Spine, где A = 1-99 - порядковый номер Spine, B = 0-255 - порядоковый номер loopback-интерфейса.\
- 172.16.C.D/32 - адресация для loopback-интерфейсов Leaf, где C = 101-199 - порядковый номер Leaf, D = 0-255 - порядоковый номер loopback-интерфейса.\
- 172.16.0.E/31 - адресация для p2p-cоединений Spine-Leaf, где D = 0-255.\
- 172.16.200.0/24 - адресация для соединений фабрики с другими сетевыми устройствами и других сетевых устройств между собой.\
- 172.16.255.F/32 - адресация для loopback-интерфейсов других сетевых устройств, где F = 0-255.\

10.1.0.0/16 le 29 - адресация для сервисов ЦОД1.

ЦОД1 \
172.17.0.0/16 le 32 - аресация сетевой инфраструктуры ЦОД2.
- 172.17.A.B/32 - адресация для loopback-интерфейсов Spine, где A = 1-99 - порядковый номер Spine, B = 0-255 - порядоковый номер loopback-интерфейса.\
- 172.17.C.D/32 - адресация для loopback-интерфейсов Leaf, где C = 101-199 - порядковый номер Leaf, D = 0-255 - порядоковый номер loopback-интерфейса.\
- 172.17.0.E/31 - адресация для p2p-cоединений Spine-Leaf, где D = 0-255.\
- 172.17.200.0/24 - адресация для соединений фабрики с другими сетевыми устройствами и других сетевых устройств между собой.\
- 172.17.255.F/32 - адресация для loopback-интерфейсов других сетевых устройств, где F = 0-255.\

10.2.0.0/16 le 29 - адресация для сервисов ЦОД2.
  

